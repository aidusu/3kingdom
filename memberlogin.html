<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>會員登入驗證</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <h2>會員登入驗證</h2>
  <form id="loginForm" method="POST" action="https://script.google.com/macros/s/AKfycbz9ZXipY_uOLP1CXC1aDwqc3AH5yi8bwPNpNMdVhiaeqEINfQUHruWCnbvATygE7gGQ/exec" target="result_iframe">
    <input type="text" name="memberId" placeholder="會員編號" required>
    <input type="hidden" name="uuid" id="uuid">
    <button type="submit">送出</button>
  </form>

  <iframe name="result_iframe" style="display:none;" onload="checkResult()"></iframe>
  <p id="resultMsg"></p>

  <script>
    document.getElementById("uuid").value = localStorage.getItem("deviceUUID") || (function () {
      const uuid = crypto.randomUUID();
      localStorage.setItem("deviceUUID", uuid);
      return uuid;
    })();

    function checkResult() {
      const hash = window.location.hash;
      const result = document.getElementById("resultMsg");

      if (hash === "#success") {
        result.textContent = "✅ 驗證成功";
        result.style.color = "green";
      } else if (hash === "#uuid") {
        result.textContent = "❌ UUID 不符";
        result.style.color = "red";
      } else if (hash === "#notfound") {
        result.textContent = "❌ 查無會員";
        result.style.color = "red";
      } else if (hash === "#error") {
        result.textContent = "❌ 發生錯誤";
        result.style.color = "red";
      }
      // 清掉 hash
      history.replaceState(null, "", " ");
    }
  </script>
</body>
</html>

